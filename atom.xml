<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>满船清梦</title>
  
  
  <link href="https://www.echo24.top/atom.xml" rel="self"/>
  
  <link href="https://www.echo24.top/"/>
  <updated>2022-02-07T08:14:31.616Z</updated>
  <id>https://www.echo24.top/</id>
  
  <author>
    <name>爱上企鹅的北极熊</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>矩阵键盘</title>
    <link href="https://www.echo24.top/2022/02/07/STM32%E2%80%944X4%E7%9F%A9%E9%98%B5%E9%94%AE%E7%9B%98/"/>
    <id>https://www.echo24.top/2022/02/07/STM32%E2%80%944X4%E7%9F%A9%E9%98%B5%E9%94%AE%E7%9B%98/</id>
    <published>2022-02-07T07:34:54.000Z</published>
    <updated>2022-02-07T08:14:31.616Z</updated>
    
    <content type="html"><![CDATA[<p>矩阵键盘与普通的一个 IO 对应一个按键的普通键盘不同。16 个按键通过图中的电路连接，构成了行和列，而只仅仅引出了 8 条线路，所以只需要 8 个 IO 口就能识别 16 个按键。</p><h2 id="IO口对按键的扫描方式"><a href="#IO口对按键的扫描方式" class="headerlink" title="IO口对按键的扫描方式"></a>IO口对按键的扫描方式</h2><h3 id="逐行扫描："><a href="#逐行扫描：" class="headerlink" title="逐行扫描："></a>逐行扫描：</h3><p>通过高四位轮流输出低电平来对矩阵键盘进行逐行扫描，当低四位接收到的数据不全为1的时候，说明有按键按下，然后通过接收到的数据是哪一位为0来判断是哪一个按键被按下。</p><h3 id="行列扫描："><a href="#行列扫描：" class="headerlink" title="行列扫描："></a>行列扫描：</h3><p>通过高四位全部输出低电平，低四位输出高电平。当接收到的数据，低四位不全为高电平时，说明有按键按下，然后通过接收的数据值，判断是哪一列有按键按下，然后再反过来，高四位输出高电平，低四位输出低电平，然后根据接收到的高四位的值判断是那一行有按键按下，这样就能够确定是哪一个按键按下了。</p><h2 id="STM32代码"><a href="#STM32代码" class="headerlink" title="STM32代码"></a>STM32代码</h2><h3 id="按键初始化函数："><a href="#按键初始化函数：" class="headerlink" title="按键初始化函数："></a>按键初始化函数：</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c">void KEY_Init(void)&#123;GPIO_InitTypeDef GPIO_InitStructure;RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOF,ENABLE);&#x2F;&#x2F;使能PORTD时钟GPIO_InitStructure.GPIO_Pin  &#x3D; GPIO_Pin_0|GPIO_Pin_1|GPIO_Pin_2|GPIO_Pin_3;&#x2F;&#x2F;PF 0 1 2 3GPIO_InitStructure.GPIO_Mode &#x3D; GPIO_Mode_Out_PP; &#x2F;&#x2F;设置成推挽输出GPIO_Init(GPIOF, &amp;GPIO_InitStructure);&#x2F;&#x2F;初始化GPIOFGPIO_InitStructure.GPIO_Pin  &#x3D; GPIO_Pin_4|GPIO_Pin_5|GPIO_Pin_6|GPIO_Pin_7;&#x2F;&#x2F;PF 4 5 6 7GPIO_InitStructure.GPIO_Mode &#x3D; GPIO_Mode_IPU; &#x2F;&#x2F;设置成上拉输入GPIO_Init(GPIOF, &amp;GPIO_InitStructure);&#x2F;&#x2F;初始化GPIOF&#125; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="按键处理函数："><a href="#按键处理函数：" class="headerlink" title="按键处理函数："></a>按键处理函数：</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c">int key_scan(void)&#123;static u8 key_up&#x3D;1;int key_num&#x3D;0;u8 temp&#x3D;0;&#x2F;&#x2F;判断列的数据缓存区u8 temp1&#x3D;0;&#x2F;&#x2F;判断行的数据缓存区GPIO_ResetBits(GPIOF,GPIO_Pin_0|GPIO_Pin_1|GPIO_Pin_2|GPIO_Pin_3);&#x2F;&#x2F;拉低行线delay_us(10);temp&#x3D;GPIO_ReadInputData(GPIOF)&amp;0xff;&#x2F;&#x2F;读出A的数据寄存器的值delay_us(1);if (key_up&amp;&amp;(temp !&#x3D; 0xf0))&#x2F;&#x2F;判断键是否按下与是否连按&#123;delay_ms(10);&#x2F;&#x2F;消抖key_up&#x3D;0;&#x2F;&#x2F;当有键按下时，将连按标志位挂起temp &#x3D; GPIO_ReadInputData(GPIOF)&amp;0xff;&#x2F;&#x2F;消抖后重新得到A的值if(temp !&#x3D; 0xf0)&#123;switch(temp)&#x2F;&#x2F;进入键盘按下的相应行线&#123;case 0xe0:&#123;GPIO_SetBits(GPIOF,GPIO_Pin_1|GPIO_Pin_2|GPIO_Pin_3|GPIO_Pin_0);&#x2F;&#x2F;依次从第一行拉低到第四行，读出A的数据，从而判断GPIO_ResetBits(GPIOF,GPIO_Pin_0);&#x2F;&#x2F;是哪一行的键盘按下，从而给出相应的键值delay_us(10);temp1&#x3D;GPIO_ReadInputData(GPIOF)&amp;0xff;if (temp1&#x3D;&#x3D;0xee)key_num&#x3D;1;else&#123;GPIO_SetBits(GPIOF,GPIO_Pin_1|GPIO_Pin_2|GPIO_Pin_3|GPIO_Pin_0);GPIO_ResetBits(GPIOF,GPIO_Pin_1);delay_us(1);temp1&#x3D;GPIO_ReadInputData(GPIOF)&amp;0xff;if (temp1&#x3D;&#x3D;0xed)key_num&#x3D;5;else&#123;GPIO_SetBits(GPIOF,GPIO_Pin_1|GPIO_Pin_2|GPIO_Pin_3|GPIO_Pin_0);GPIO_ResetBits(GPIOF,GPIO_Pin_2);delay_us(1);temp1&#x3D;GPIO_ReadInputData(GPIOF)&amp;0xff;if (temp1&#x3D;&#x3D;0xeb)key_num&#x3D;9;elsekey_num&#x3D;13;&#125;&#125;&#125;break;case 0xd0:&#123;GPIO_SetBits(GPIOF,GPIO_Pin_1|GPIO_Pin_2|GPIO_Pin_3|GPIO_Pin_0);GPIO_ResetBits(GPIOF,GPIO_Pin_0);delay_us(1);temp1&#x3D;GPIO_ReadInputData(GPIOF)&amp;0xff;if (temp1&#x3D;&#x3D;0xde)key_num&#x3D;2;else&#123;GPIO_SetBits(GPIOF,GPIO_Pin_1|GPIO_Pin_2|GPIO_Pin_3|GPIO_Pin_0);GPIO_ResetBits(GPIOF,GPIO_Pin_1);delay_us(1);temp1&#x3D;GPIO_ReadInputData(GPIOF)&amp;0xff;if (temp1&#x3D;&#x3D;0xdd)key_num&#x3D;6;else&#123;GPIO_SetBits(GPIOF,GPIO_Pin_1|GPIO_Pin_2|GPIO_Pin_3|GPIO_Pin_0);GPIO_ResetBits(GPIOF,GPIO_Pin_2);delay_us(1);temp1&#x3D;GPIO_ReadInputData(GPIOF)&amp;0xff;if (temp1&#x3D;&#x3D;0xdb)key_num&#x3D;10;elsekey_num&#x3D;14;&#125;&#125;&#125;break;case 0xb0:&#123;GPIO_SetBits(GPIOF,GPIO_Pin_1|GPIO_Pin_2|GPIO_Pin_3|GPIO_Pin_0);GPIO_ResetBits(GPIOF,GPIO_Pin_0);delay_us(1);temp1&#x3D;GPIO_ReadInputData(GPIOF)&amp;0xff;if (temp1&#x3D;&#x3D;0xbe)key_num&#x3D;3;else&#123;GPIO_SetBits(GPIOF,GPIO_Pin_1|GPIO_Pin_2|GPIO_Pin_3|GPIO_Pin_0);GPIO_ResetBits(GPIOF,GPIO_Pin_1);delay_us(1);temp1&#x3D;GPIO_ReadInputData(GPIOF)&amp;0xff;if (temp1&#x3D;&#x3D;0xbd)key_num&#x3D;7;else&#123;GPIO_SetBits(GPIOF,GPIO_Pin_1|GPIO_Pin_2|GPIO_Pin_3|GPIO_Pin_0);GPIO_ResetBits(GPIOF,GPIO_Pin_2);delay_us(1);temp1&#x3D;GPIO_ReadInputData(GPIOF)&amp;0xff;if (temp1&#x3D;&#x3D;0xbb)key_num&#x3D;11;elsekey_num&#x3D;15;&#125;&#125;&#125;break;case 0x70:&#123;GPIO_SetBits(GPIOF,GPIO_Pin_1|GPIO_Pin_2|GPIO_Pin_3|GPIO_Pin_0);GPIO_ResetBits(GPIOF,GPIO_Pin_0);delay_us(1);temp1&#x3D;(GPIO_ReadInputData(GPIOF)&amp;0xff);if (temp1&#x3D;&#x3D;0x7e)key_num&#x3D;4;else&#123;GPIO_SetBits(GPIOF,GPIO_Pin_1|GPIO_Pin_2|GPIO_Pin_3|GPIO_Pin_0);GPIO_ResetBits(GPIOF,GPIO_Pin_1);delay_us(1);temp1&#x3D;GPIO_ReadInputData(GPIOF)&amp;0xff;if (temp1&#x3D;&#x3D;0x7d)key_num&#x3D;8;else&#123;GPIO_SetBits(GPIOF,GPIO_Pin_1|GPIO_Pin_2|GPIO_Pin_3|GPIO_Pin_0);GPIO_ResetBits(GPIOF,GPIO_Pin_2);delay_us(1);temp1&#x3D;GPIO_ReadInputData(GPIOF)&amp;0xff;if (temp1&#x3D;&#x3D;0x7b)key_num&#x3D;12;elsekey_num&#x3D;16;&#125;&#125;&#125;break;default :return 0;&#125;&#125;&#125;else if(temp &#x3D;&#x3D; 0xf0)&#123;key_up&#x3D;1;&#x2F;&#x2F;当没有键按下后，将连按标志复位&#125;return key_num;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
    
    
    <summary type="html">STM32基础外设之矩阵键盘</summary>
    
    
    
    <category term="单片机" scheme="https://www.echo24.top/categories/%E5%8D%95%E7%89%87%E6%9C%BA/"/>
    
    <category term="STM32" scheme="https://www.echo24.top/categories/%E5%8D%95%E7%89%87%E6%9C%BA/STM32/"/>
    
    
    <category term="单片机" scheme="https://www.echo24.top/tags/%E5%8D%95%E7%89%87%E6%9C%BA/"/>
    
    <category term="STM32" scheme="https://www.echo24.top/tags/STM32/"/>
    
  </entry>
  
  <entry>
    <title>辛弃疾</title>
    <link href="https://www.echo24.top/2022/02/03/%E8%BE%9B%E5%BC%83%E7%96%BE/"/>
    <id>https://www.echo24.top/2022/02/03/%E8%BE%9B%E5%BC%83%E7%96%BE/</id>
    <published>2022-02-03T12:34:54.000Z</published>
    <updated>2022-02-07T08:14:16.523Z</updated>
    
    <content type="html"><![CDATA[<p>辛弃疾（1140年5月28日—1207年10月3日），原字坦夫，后改字幼安，中年后别号稼轩  ，山东东路济南府历城县（今山东省济南市历城区）人。南宋官员、将领、文学家，豪放派词人，有“词中之龙”之称。与苏轼合称“苏辛”，与李清照并称“济南二安”。</p><p>出生时山东已为金人所占  ，早年与党怀英齐名北方，号称“辛党”。青年时参与耿京起义，擒杀叛徒张安国，回归南宋，献《美芹十论》《九议》等，条陈战守之策。先后在江西、湖南、福建等地为守臣，平定荆南茶商赖文政起事，又力排众议，创制飞虎军，以稳定湖湘地区。由于他与当政的主和派政见不合，故而屡遭劾奏，数次起落，最终退隐山居。开禧北伐前后，宰臣韩侂胄接连起用辛弃疾知绍兴、镇江二府，并征他入朝任枢密都承旨等官，均遭辞免。开禧三年（1207年），辛弃疾抱憾病逝，享年六十八岁。宋恭帝时获赠少师，谥号“忠敏”。</p><p>辛弃疾一生以恢复为志，以功业自许，却命运多舛，壮志难酬。但他始终没有动摇恢复中原的信念，而是把满腔激情和对国家兴亡、民族命运的关切、忧虑，全部寄寓于词作之中。其词艺术风格多样，以豪放为主，风格沉雄豪迈又不乏细腻柔媚之处，题材广阔又善化用典故入词，抒写力图恢复国家统一的爱国热情，倾诉壮志难酬的悲愤，对当时执政者的屈辱求和颇多谴责，也有不少吟咏祖国河山的作品。现存词六百多首，有《稼轩长短句》等传世。</p>]]></content>
    
    
    <summary type="html">鲸饮未吞海，剑气已横秋！</summary>
    
    
    
    <category term="人文" scheme="https://www.echo24.top/categories/%E4%BA%BA%E6%96%87/"/>
    
    
    <category term="古诗文" scheme="https://www.echo24.top/tags/%E5%8F%A4%E8%AF%97%E6%96%87/"/>
    
    <category term="人文" scheme="https://www.echo24.top/tags/%E4%BA%BA%E6%96%87/"/>
    
  </entry>
  
  <entry>
    <title>苏轼</title>
    <link href="https://www.echo24.top/2022/01/30/%E8%8B%8F%E8%BD%BC/"/>
    <id>https://www.echo24.top/2022/01/30/%E8%8B%8F%E8%BD%BC/</id>
    <published>2022-01-30T08:31:42.000Z</published>
    <updated>2022-02-07T08:14:05.767Z</updated>
    
    <content type="html"><![CDATA[<p>苏轼（1037年1月8日—1101年8月24日），字子瞻，一字和仲，号铁冠道人、东坡居士，世称苏东坡、苏仙   、坡仙   ，汉族，眉州眉山（今四川省眉山市）人，祖籍河北栾城，北宋文学家、书法家、美食家、画家，历史治水名人。 </p><p>嘉祐二年（1057年），苏轼进士及第。宋神宗时在凤翔、杭州、密州、徐州、湖州等地任职。元丰三年（1080年），因“乌台诗案”被贬为黄州团练副使。宋哲宗即位后任翰林学士、侍读学士、礼部尚书等职，并出知杭州、颍州、扬州、定州等地，晚年因新党执政被贬惠州、儋州。宋徽宗时获大赦北还，途中于常州病逝。宋高宗时追赠太师；宋孝宗时追谥“文忠”。</p><p>苏轼是北宋中期文坛领袖，在诗、词、散文、书、画等方面取得很高成就。文纵横恣肆；诗题材广阔，清新豪健，善用夸张比喻，独具风格，与黄庭坚并称“苏黄”；词开豪放一派，与辛弃疾同是豪放派代表，并称“苏辛”   ；散文著述宏富，豪放自如，与欧阳修并称“欧苏”，为“唐宋八大家”之一。苏轼善书，“宋四家”之一；擅长文人画，尤擅墨竹、怪石、枯木等。李志敏评价：“苏轼是全才式的艺术巨匠。” </p><p>作品有《东坡七集》《东坡易传》《东坡乐府》《潇湘竹石图》《枯木怪石图》等。</p>]]></content>
    
    
    <summary type="html">一点浩然气 千里快哉风！</summary>
    
    
    
    <category term="人文" scheme="https://www.echo24.top/categories/%E4%BA%BA%E6%96%87/"/>
    
    
    <category term="古诗文" scheme="https://www.echo24.top/tags/%E5%8F%A4%E8%AF%97%E6%96%87/"/>
    
    <category term="人文" scheme="https://www.echo24.top/tags/%E4%BA%BA%E6%96%87/"/>
    
  </entry>
  
</feed>
